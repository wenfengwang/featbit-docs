# 実験の理解

## 概要

このトピックでは、FeatBitの実験機能の概念と価値について説明します。実験を使用すると、チームが関心を持つメトリクスを追跡することで、ユーザーに対するフラグの効果を測定できます。

## 実験の理解

実験を使用すると、アプリやインフラストラクチャに展開した機能の影響を検証できます。ページビュー、クリック、読み込み時間、インフラストラクチャコストなどの要素を測定できます。

FeatBitの環境内で作成したメトリクスをフラグに接続することで、ユーザーの行動の変化を測定することができます。これにより、開発チームが提供する機能がビジネス目標に沿っているかをより正確に判断できます。

上記の画像は、**ABテスト**の結果を示しており、どのバージョン（v1またはv2）がユーザーにデモを簡単に完了させたかを示しています。バージョン2が競争に勝ち、バージョン2が**はじめに進む**デモの最終バージョンとなりました。

## 実験の使用

実験は組織内のさまざまな役割の人々が利用できるよう設計されています。たとえば、製品マネージャーは提供する機能の価値を測定するために実験を使用し、デザイナーはUIとUXコンポーネントの多変量テストを実施するために、DevOpsエンジニアはインフラストラクチャ変更の効果やパフォーマンスをテストするために使用できます。

実験がフラグによる肯定的な影響を示す場合、そのフラグをユーザー全体に展開して価値を最大化できます。また、1つのフラグから得る結果が気に入らない場合、それを無効にしてユーザーに与える影響を最小限に抑えることができます。

実験でできることには、以下があります。

- **A/B/nテスト**（多変量テストとも呼ばれる）
- 任意のタイミングで実験を開始および停止して、データが記録されるタイミングを細かく制御できる
- 実験結果の信頼区間を確認して、最も影響を信頼できる変化を選択できる
- 特定のユーザーグループを実験に露出させることで、テスト対象の観察対象を洗練できる
- 機能の複数の変化をテストすることで新しいアイデアを検証する
- 機能を構築する前に、機能の複数の変化を試してユーザーベースの興味を判断する
- 機能、サービス、またはAPIのパフォーマンスデータを収集する
- ユーザーが好む機能を判断することで製品の採用を増やす
- 成功した変化をユーザー全体に展開することで収益と変換率を向上させる
- その他

## 実験結果の分析

実験データは、**実験**タブのフィーチャーフラグ詳細ページに収集され、ほぼリアルタイムで実験データが表示されます。

実験データが収集されると、FeatBitはテスト中のすべての変化の中で最も適切な選択肢を計算します。目的の影響を持つフラグの変化を決定したら、FeatBitの割合展開機能を使用して、その変化を徐々にユーザー全体に展開できます。割合展開について詳しくは、[割合展開](../feature-flags/targeting-users-with-flags/percentage-rollouts.md)を参照してください。

Clickhouse＆APIを使用して実験データを外部宛先にエクスポートできます。

## 実験のベストプラクティス

実験を使用する際には、以下のベストプラクティスを考慮してください。

- **開発するすべての新機能にフラグを使用します。** これはベストプラクティスですが、FeatBitで実験を実行する際に特に役立ちます。すべての機能にフラグを付けることで、製品の任意の側面を迅速に実験に変えることができます。
- **最初から実験を考慮します。** 機能の開発計画段階で仮説を立て、機能の展開と同時に実験を実行できるようチーム全体で準備します。
- **何を測定するかを定義します。** チーム全体で最適化する具体的なメトリクスを定義し、成功の基準を確立します。
- **相互に配慮して実験を計画します。** 複数の実験を同時に実行する場合、類似または相反するデータを収集しないようにします。
- **ログイン前とログイン後のアプリに交流するユーザーを関連付けます。** ユーザーがログインしていない状態とログインした状態の両方から実験にアクセスする場合、それぞれの状態で独自のユーザーキーが生成されます。

さまざまな結果を測定するために実験を使用できます。例としては、以下があります。

- ElasticsearchとSOLR、Algoliaなど、異なる検索実装の効果をテストする
- 提供する機能がページの読み込み時間を増減させているかをトラッキングする
- ユーザーがページのさまざまな要素をどれだけ頻繁にクリックするかをモニタリングすることで変換率を計算する

## 実験事象の理解

実験事象は、SDKが生成する実験を反映するイベントの総称です。実験事象には2つのカテゴリがあります。

* **メトリクスイベント**：実験の実行に使用されるメトリクスからの「クリック」、「ページビュー」、「カスタム」イベント
* **評価イベント**：実験を実行中のターゲティングルールを含むフラグからの「機能」イベント

#### メトリクスイベントの理解

すべてのFeatBit SDKは、次のようなSDKのメソッドを呼び出すと「カスタム」メトリクスイベントを送信します。

```
fbClient.sendCustomEvent([{
  eventName: 'your event name',
  numericValue: 1
}])
```

trackメソッドについて詳しくは、[SDKs](https://github.com/featbit/featbit-js-client-sdk#experiments-abn-testing)を参照してください。

#### 評価イベントの理解

すべてのFeatBit SDKは、実験中のフラグの`.variation()`メソッドを呼び出すと「機能」のコンバージョンイベントを送信します。