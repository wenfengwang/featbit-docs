# 実験についての理解

## 概要

このトピックでは、FeatBitの実験機能のコンセプトとその価値について説明します。実験を通じて、チームが重視するメトリクスを追跡し、フラグがユーザーに与える影響を測定することができます。

## 実験についての理解

実験機能を使うことで、アプリケーションやインフラに展開した機能の影響を検証できます。ページビュー、クリック数、ロード時間、インフラコストなど、さまざまな要素を測定することが可能です。

FeatBit環境内のフラグに自分たちが作成したメトリクスを関連付けることで、ユーザーの行動がフラグの評価によってどのように変化するかを測定できます。これにより、開発チームがリリースする機能がビジネス目標に合致するよう、より情報に基づいた意思決定を行うことができます。

![](../experimentation/assets/understanding-experimentation/001.webp)

上の画像は、ユーザーがデモを容易に完了できるバージョン（v1またはv2）の**ABテスト**結果を示しています。バージョン2が競争に勝利し、**Get Started**デモの最終バージョンとなりました。

## 実験の利用

実験は、組織内のさまざまな役割に対応できるように設計されています。例えば、プロダクトマネージャーは実験を利用してリリースする機能の価値を測定し、デザイナーはUIやUXコンポーネントの多変量テストを行うために実験を利用し、DevOpsエンジニアはインフラの変更の効果とパフォーマンスをテストするために実験を利用できます。

実験の結果、フラグが肯定的な影響をもたらすことがわかれば、そのフラグを全ユーザーベースに展開して価値を最大化することができます。逆に、あるフラグの結果に満足できなければ、そのフラグをオフにしてユーザーベースへの影響を最小限に抑えることができます。

実験を利用することでできることは以下の通りです：

* A/B/nテスト（別名多変量テスト）
* 実験はいつでも開始または停止できるため、データの記録タイミングを細かく制御できます
* 実験結果の信頼区間をレビューして、最も影響力のあるバリエーションを信頼して選択できます
* 特定のユーザーグループに実験を公開し、テスト対象のユーザーを精査します
* 機能の複数のバリエーションをテストして新しいアイデアを検証します
* 機能を構築する前に、ユーザーベースの関心を判断します
* 機能、サービス、またはAPIのパフォーマンスデータを収集します
* ユーザーが好む機能を特定して製品の採用を増やします
* 成功したバリエーションを他のユーザーベースに展開して収益とコンバージョン率を向上させます
* その他多くのこと。

## 実験結果の分析

実験データは、機能フラグの詳細ページにある**Experimentation**タブで収集され、実験データはほぼリアルタイムで表示されます。

実験がデータを収集するにつれて、FeatBitはテスト中のすべてのバリエーションの中から最も良い選択となる可能性が高いバリエーションを計算します。どのフラグバリエーションが望む影響を持つかを決定した後、FeatBitのパーセンテージロールアウト機能を使用して、そのバリエーションをユーザー全体に段階的に展開できます。パーセンテージロールアウトについて詳しくは、[パーセンテージロールアウト](../feature-flags/targeting-users-with-flags/percentage-rollouts.md)をご覧ください。

Clickhouse & APIsを使用して、実験データを外部の宛先にエクスポートすることができます。

## 実験のベストプラクティス

実験を使用する際には、以下のベストプラクティスを考慮してください：

* **開発する新しい機能には必ずフィーチャーフラグを使用してください。** これはベストプラクティスですが、特にFeatBitで実験を行う際には有効です。すべての機能にフラグを設定することで、製品の任意の側面を迅速に実験に変えることができます。
* **初日から実験を考慮に入れてください。** 機能開発の計画段階で仮説を立てることで、機能がローンチされたらすぐに実験を開始できるようになります。
* **測定するものを定義してください。** チームと協力して、どの具体的なメトリクスを最適化するか、どの結果が成功を意味するかを明確にします。
* **実験を相互に関連させて計画してください。** 複数の実験を同時に実行する場合は、それらが類似または競合するデータを収集しないようにしてください。
* **ログイン前後でアプリを使用するユーザーを関連付けてください。** ユーザーがログアウト状態とログイン状態の両方から実験にアクセスした場合、それぞれの状態で別々のユーザーキーが生成されます。

実験を使用して測定できる結果は多岐にわたります。実験の例としては以下があります：

* Elasticsearch、SOLR、Algoliaなど、異なる検索実装の効果をテストする
* リリースされた機能がページロード時間にどのように影響を与えるかを追跡する
* ユーザーがページ要素をどの程度クリックするかを監視し、コンバージョン率を計算する

## 実験イベントについての理解

実験イベントは、SDKが生成する実験イベント数に影響を与えるイベントのことです。実験イベントには2つのカテゴリがあります：

* **メトリックイベント**：実験で使用されるメトリクスからの`click`、`page view`、`custom`イベント。
* **評価イベント**：実験で使用されるターゲティングルールを含むフラグからの`feature`イベント。

#### メトリックイベントについての理解

すべてのFeatBit SDKは、SDKのメソッドを呼び出す際に`custom`メトリックイベントを送信します：

```
fbClient.sendCustomEvent([{
  eventName: 'your event name',
  numericValue: 1
}])
```

trackメソッドについて詳しくは、[SDKs](https://github.com/featbit/featbit-js-client-sdk#experiments-abn-testing)をご覧ください。

#### 評価イベントについての理解

すべてのFeatBit SDKは、実験中のフラグに対してSDKの`.variation()`メソッドを呼び出す際に`feature`コンバージョンイベントを送信します。
