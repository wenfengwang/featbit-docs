# 実験の作成

## 概要

このトピックでは、FeatBitでの実験の設定と構成方法について説明します。メトリックの概念を紹介し、さまざまなメトリックの種類とフィーチャーフラグとの対話方法を説明します。

FeatBitでは、メトリックとフラグの組み合わせが実験です。実験を通じて、フラグがユーザーに与える影響を計測し、チームが関心を持つメトリックにマッピングすることができます。

## メトリックの作成

メトリックは、フラグイベントを評価する基準です。URLへのアクセス頻度からページの読み込みにかかる時間まで、さまざまなことをトラッキングするためにメトリックを使用できます。ユーザーがURLを読み込んだり、要素をクリックしたり、メトリックがトラッキングする動作に参加したりする場合は、FeatBit SDKを使用してイベントを実験に送信できます。

新しい実験ごとに新しいメトリックを作成する必要はありません。1つのメトリックを複数の実験で再利用することができます。これにより、さまざまなフラグでメトリックのパフォーマンスを比較することができます。同様に、単一の実験では主要なメトリックとセカンダリメトリックを使用できます。これにより、さまざまな測定に対する変動のパフォーマンスを観察することができます。

### プライマリメトリックとセカンダリメトリックの使用

実験では、1つのメトリックのみをプライマリメトリックとして指定できますが、必要に応じて実験にセカンダリメトリックを追加することもできます。追加の測定結果を追跡するためにセカンダリメトリックを使用する場合、1つの実験に10個以上のメトリックを使用しないことをおすすめします。

プライマリメトリックは、時には「全体評価基準」とも呼ばれます。実験の優勝バリエーションについての決定を行う際には、プライマリメトリックに基づいて決定を行うことをお勧めします。複数のメトリックを決定に含めると、決定が複雑になるためです。

1つのメトリックを使用する場合、2つの可能な結果があります：上昇または下降です。2つのメトリックを使用する場合、上昇/下降、下降/上昇、上昇/上昇、または下降/下降の4つの可能な結果の組み合わせがあります。

実験に追加するメトリックの数が増えるにつれ、可能な結果の数も急速に増加します。3つのメトリックを使用する場合、8つの異なる結果の組み合わせがあります。10個のメトリックを使用する場合、1,024個の異なる結果の組み合わせがあります。このため、決定はプライマリメトリックのみに基づくことをお勧めします。

### メトリックの種類

以下の表は、メトリックの種類とそれらのSDK互換性について説明しています。

<table><thead><tr><th width="217.33333333333331">メトリックの種類</th><th>説明 &#x26; 例</th></tr></thead><tbody><tr><td>クリック変換</td><td>ユーザーインターフェース（UI）要素のクリックを追跡します。<br><br>- ユーザーは「保存」ボタンをどれくらいクリックしますか？<br>- ユーザーはリンクを何回クリックしますか？<br>- プロセスのどの時点でサインアップの招待を表示するのが最適ですか？</td></tr><tr><td>カスタム変換</td><td>任意のイベントのイベントを追跡します。<br><br>- ユーザーの検索では特定のサービスが呼び出されますか？<br>- 顧客は一定期間内にカスタマーサービスに連絡しますか？<br>- 30日以内に顧客は契約を更新しますか？ユーザーの支払いは成功しますか？</td></tr><tr><td>ページビュー変換</td><td>ページが表示された回数を追跡します。<br><br>- ユーザーはブログ投稿を何回表示しますか？</td></tr><tr><td>カスタム数値</td><td>数値の変動をベースラインに対する増減として追跡します。<br><br>- ストアでのトランザクションごとのユーザーの支出はどれくらいですか？<br>- ユーザーの総支出はいくらですか？<br>- トランザクションごとにユーザーは何個のアイテムを購入しますか？<br>- ユーザーはトータルでいくつのアイテムを購入しますか？<br>- ページ上でユーザーが費やす時間はどれくらいですか？<br>- サーバーがリクエストに応答するまでにどれくらい時間がかかりますか？<br>- 最初のバイトまでの経過時間はどれくらいですか？</td></tr></tbody></table>

### メトリックの作成

**実験**ページに移動し、**メトリック**タブで**メトリックの追加**ボタンをクリックします。

![](../experimentation/assets/creating-experiments/001.webp)

メトリックドロワーで、メトリックの情報を入力します。

![](../experimentation/assets/creating-experiments/002.webp)

* `名前`：メトリックの名前
* `説明`：（オプション）メトリックの説明
* `メンテナ`：このメトリックのメンテナ
* `イベントタイプ`：FeatBitは現在は「カスタム」イベントタイプのみをサポートしていますが、実際には以下のタイプをサポートしています：
  * カスタム変換：セレクターの下に「変換率」を選択する必要があります
  * カスタム数値：セレクターの下に「数値」を選択する必要があります
  * クリック変換およびページビュー変換：これらはカスタム変換として扱うことができます
* `イベント名`：FeatBit実験評価でイベントを識別するための名前。イベントをトラッキングするためにSDKを呼び出す際にこの名前がパラメータとして渡されます。
* `単位`：イベントタイプとして数値を選択した場合、測定される数値の種類を識別します。
* `勝利基準`：「ベースラインよりも高い」または「ベースラインよりも低い」を選択して勝利基準を定義します。

## 実験の作成

概要サブパネルに戻り、**追加**ボタンをクリックします。

![](../experimentation/assets/creating-experiments/003.webp)

**実験**ドロワーで、作成したフィーチャーフラグを選択し、**メトリック**を選択し、ベースラインとして変動を選択します。**保存**ボタンをクリックします。

![](../experimentation/assets/creating-experiments/004.webp)

## 実験の実行

実験リストで、実験の **結果を確認**ボタンをクリックします。

![](../experimentation/assets/creating-experiments/005.webp)

フィーチャーフラグの **実験**タブに移動します。実験を開始するために **スタート**ボタンをクリックします！

![](../experimentation/assets/creating-experiments/006.webp)

## 実験対象オーディエンスの作成

フラグのデフォルトルールで実験を実行することもできますし、特定のフラグのターゲティングルールを選択してカスタム実験対象オーディエンスを作成することもできます。収集したユーザ属性によってターゲットを設定することができます。詳細については[ターゲティングルール](../feature-flags/targeting-users-with-flags/targeting-rules.md)を読んでください。

実験を構築する際には、フラグに遭遇するユーザートラフィックのすべてまたは一部を実験に割り当てることができます。オーディエンスの割り当てにより、実験オーディエンスの選択時の柔軟性が向上し、正確な実験結果が得られます。FeatBitは、実験に参加するユーザーのみを分析します。

**A/Bテストのルールを設定する**ボタンをクリックして、特定のフラグのターゲティングルールを選択できます。

![](../experimentation/assets/creating-experiments/007.webp)

ドロワーパネルで特定のABテストトラフィックを設定できます。下のイメージは、デフォルトルールに一致するトータルユーザーの10％のみが実験に含まれることを示しています。v1のデフォルトルールに一致するユーザーの80％は実験から除外されます。

![](../experimentation/assets/creating-experiments/008.webp)