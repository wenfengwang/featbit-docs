# 実験の作成

## 概要

このトピックでは、FeatBitで実験を設定して構成する方法について説明します。メトリックの概念を紹介し、異なるメトリックの種類を説明し、メトリックがフィーチャーフラグとどのように相互作用するかを説明します。

FeatBitでは、メトリックとフラグの組み合わせが実験となります。実験を使用すると、チームが関心を持つメトリックにフラグの影響を測定できます。

## メトリックの作成

メトリックは、フラグイベントを評価するための基準です。ユーザーがURLにアクセスする頻度から、そのURLがページのロードにかかる時間まで、さまざまなことをトラッキングするためにメトリックを使用できます。ユーザーがURLをロードしたり、要素をクリックしたり、メトリックがトラッキングする行動に参加したりする場合、FeatBit SDKを使用してイベントを実験に送信できます。

新しい実験ごとに新しいメトリックを作成する必要はありません。既存のメトリックを複数の実験で再利用できるため、異なるフラグでメトリックのパフォーマンスを比較できます。同様に、単一の実験では、プライマリメトリックとセカンダリメトリックを使用できます。これにより、さまざまな測定に対するバリエーションのパフォーマンスを観察できます。

### プライマリおよびセカンダリメトリックの使用

実験でプライマリメトリックを1つだけ指定できますが、追加の測定のパフォーマンスを追跡したい場合は、実験にセカンダリメトリックを添付できます。実験ごとにメトリックを10個を超えないようにすることをお勧めします。

プライマリメトリックは、ときに「総合評価基準」と呼ばれます。実験における勝利したバリエーションについての意思決定を行う場合、複数のメトリックを含めると、意思決定がより複雑になるため、判断を下す際にはプライマリメトリックに基づくべきです。

1つのメトリックを使用する場合、上または下の2つの可能な結果があります。2つのメトリックを使用する場合、上/下、下/上、上/上、または下/下の4つの可能な結果の組み合わせがあります。

実験にメトリックを追加するたびに、可能な結果の数が急速に増加します。3つのメトリックを使用する場合、8つの異なる可能な結果の組み合わせがあります。10個のメトリックを使用する場合、1,024の異なる可能な結果の組み合わせがあります。このため、意思決定をプライマリメトリックにのみ基づくことをお勧めします。

### メトリックの種類

以下の表は、メトリックでトラッキングできるイベントの種類とそれらのSDKとの互換性を説明しています。

<table><thead><tr><th width="217.33333333333331">メトリックの種類</th><th>説明と使用例</th></tr></thead><tbody><tr><td>クリックコンバージョン</td><td>ユーザーインターフェイス（UI）要素のクリックをトラッキングします。<br><br>- ユーザーは「保存」ボタンをどのくらい頻繁にクリックしますか？ <br>- ユーザーはリンクを何回クリックしますか？ <br>- プロセス中に最適な時期は、サインアップの招待を表示する時ですか？</td></tr><tr><td>カスタムコンバージョン</td><td>任意のイベントのトラッキングをします。<br><br>- ユーザーの検索は特定のサービスを呼び出していますか？ <br>- 顧客は一定期間内にカスタマーサービスに連絡していますか？ <br>- 顧客は30日以内に契約を更新しますか？ ユーザーの支払いは成功していますか？</td></tr><tr><td>ページビューコンバージョン</td><td>ページが表示された回数をトラッキングします。<br><br>- ユーザーはブログ投稿を何回見ますか？</td></tr><tr><td>カスタム数値</td><td>ベースラインに対する数値の増減をトラッキングします。<br><br>- ユーザーはストアでの取引ごとにいくら費やしていますか？ <br>- ユーザーは合計でいくら費やしていますか？ <br>- ユーザーは取引ごとに何個のアイテムを購入していますか？ <br>- ユーザーは合計で何個のアイテムを購入していますか？ <br>- ユーザーはページでどのくらいの時間を費やしていますか？ <br>- サーバーがリクエストに応答するまでどのくらいかかりますか？ <br>- 最初のバイトまでの時間はどのくらいですか？</td></tr></tbody></table>

### メトリックの作成

**実験** ページに移動し、**メトリック** タブで **メトリックの追加** ボタンをクリックします。

![](../experimentation/assets/creating-experiments/001.webp)

メトリックのドロワーで、メトリックの情報を入力します。

![](../experimentation/assets/creating-experiments/002.webp)

* `名前`、メトリックの名前
* `説明`、(任意) メトリックの説明
* `メンテナー`、このメトリックのメンテナー
* `イベントタイプ`、FeatBitには現在「カスタム」イベントタイプのみがありますが、実際には以下のタイプをサポートしています：
  * カスタムコンバージョン、セレクターの下で **コンバージョン率** を選択する必要があります
  * カスタム数値、セレクターの下で **数値** を選択する必要があります
  * クリックコンバージョンおよびページビューコンバージョン、これらはカスタムコンバージョンとして扱うことができます
* `イベント名`、FeatBitの実験評価でイベントを識別する名前。この名前は、イベントをトラッキングするためにSDKを呼び出す際にパラメータとして渡されます。
* `単位`、イベントタイプを数値に選択した場合、測定している数値の種類を識別します。
* `勝利基準`、`ベースラインより高い`または`ベースラインより低い`を選択して、勝利基準を定義します

## 実験の作成

**概要** サブパネルに戻り、**追加** ボタンをクリックします

![](../experimentation/assets/creating-experiments/003.webp)

**実験** ドロワーで、以前に作成したフィーチャーフラグを選択し、**メトリック** を選択し、ベースラインとして変化を選択します。**保存** ボタンをクリックします。

![](../experimentation/assets/creating-experiments/004.webp)

## 実験の実行

実験リストで、実験の **結果を確認** ボタンをクリックします。

![](../experimentation/assets/creating-experiments/005.webp)

フィーチャーフラグの**実験** タブに移動します。実験を開始するために、実験で**開始** ボタンをクリックします。

![](../experimentation/assets/creating-experiments/006.webp)

## 実験オーディエンスの作成

フラグのデフォルトルールで実験を実行するか、特定のフラグターゲティングルールを選択してカスタム実験オーディエンスを作成することができます。収集したユーザ属性によってターゲットを絞ることができます。詳細は、[ターゲティングルール](../feature-flags/targeting-users-with-flags/targeting-rules.md) を参照してください。

実験を行う際に、フラグに遭遇するユーザートラフィック全体または一部を割り当てることができます。オーディエンスの割り当てにより、実験の正確な結果を確保しつつ、フラグに遭遇するユーザーをフレキシブルに選択できます。FeatBit は、実験に参加するユーザーのみを分析します。

特定のフラグターゲティングルールを選択するには、**A/Bテストルールの設定** ボタンをクリックします。

![](../experimentation/assets/creating-experiments/007.webp)

ドロワーパネルで特定のA/Bテストトラフィックを構成できます。以下の画像では、デフォルトルールに一致した合計ユーザーのうち10%のみが実験に含まれています。デフォルトルールのv1に一致したユーザーのうち80%は実験から除外されています。

![](../experimentation/assets/creating-experiments/008.webp)