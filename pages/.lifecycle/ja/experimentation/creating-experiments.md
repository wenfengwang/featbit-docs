# 実験の作成

## 概要

このトピックでは、FeatBit で実験をセットアップして構成する方法について説明します。メトリクスの概念を紹介し、さまざまなメトリクスの種類について説明し、メトリクスが機能フラグと相互作用して実験を作成する方法について説明します。

FeatBitでは、メトリクスとフラグの組み合わせが実験です。実験では、チームが重視する指標にフラグをマッピングすることで、ユーザーに対するフラグの影響を測定できます。

## メトリクスの作成 

メトリクスは、フラグイベントを評価するための尺度です。メトリクスを使用すると、ユーザーがURLにアクセスする頻度から、そのURLがページをロードするまでの時間まで、あらゆる種類のことを追跡できます。ユーザーがURLをロードしたり、要素をクリックしたり、メトリクスが追跡する行動に参加したりした場合、FeatBit SDKを使用して実験にイベントを送信できます。

新しい実験ごとに新しいメトリクスを作成する必要はありません。既存のメトリクスを複数の実験で再利用できるため、メトリクスのパフォーマンスをさまざまなフラグで比較できます。同様に、1つの実験でプライマリメトリクスとセカンダリメトリクスを使用して、さまざまな測定値に対するバリエーションのパフォーマンスを観察できます。

### プライマリメトリクスとセカンダリメトリクスの使用 

実験では、プライマリメトリクスとして1つのメトリクスのみを指定できますが、追加の測定値のパフォーマンスを追跡したい場合は、セカンダリメトリクスを実験に添付できます。実験ごとに10個以上のメトリクスを使用しないことを推奨します。

プライマリメトリクスは、「総合評価基準」とも呼ばれます。実験で勝利バリエーションについての決定を下す際には、複数のメトリクスを決定に含めると非常に複雑になるため、プライマリメトリクスのみに基づいて決定を行うべきです。

メトリクスを1つだけ使用している場合、結果は上昇または下降の2つの可能性があります。2つのメトリクスを使用している場合、結果の組み合わせは上昇/下降、下降/上昇、上昇/上昇、または下降/下降の4つがあります。

実験にメトリクスを追加するたびに、考えられる結果は急速に増加します。3つのメトリクスを使用している場合、8つの異なる結果の組み合わせがあります。10個のメトリクスを使用している場合、考えられる結果の組み合わせは1,024通りあります。このため、決定を行う際にはプライマリメトリクスのみに基づいて行うことを推奨します。

### メトリクスの種類

次の表では、メトリクスで追跡できるイベントの種類と、そのSDK互換性について説明します：

<table><thead><tr><th width="217.33333333333331">メトリクスの種類</th><th>説明 &#x26; 使用例</th></tr></thead><tbody><tr><td>クリックコンバージョン</td><td>ユーザーインターフェース(UI)要素のクリックを追跡します。<br><br>- ユーザーはどのくらいの頻度で「保存」ボタンをクリックしますか?<br>- ユーザーはリンクを何回クリックしますか?<br>- サインアップの招待を表示するプロセス中の最適なポイントはいつですか?</td></tr><tr><td>カスタムコンバージョン</td><td>任意のイベントを追跡します。<br><br>- ユーザー検索は特定のサービスを呼び出しますか?<br>- 顧客は一定期間内にカスタマーサービスに連絡しますか?<br>- 顧客は30日以内に契約を更新しますか? ユーザーの支払いは成功しますか?</td></tr><tr><td>ページビューコンバージョン</td><td>ページが閲覧された回数を追跡します。<br><br>- ユーザーはブログ投稿を何回閲覧しますか?</td></tr><tr><td>カスタム数値</td><td>設定したベースラインに対する数値の増減を追跡します。<br><br>- ユーザーはストアでのトランザクションごとにいくら費やしますか?<br>- ユーザーは合計でいくら使っていますか?<br>- ユーザーはトランザクションごとにいくつのアイテムを購入しますか?<br>- ユーザーが購入したアイテムの合計数はいくつですか?<br>- ユーザーはページにどのくらいの時間を費やしていますか?<br>- サーバーがリクエストに応答するのにどのくらいの時間がかかりますか?<br>- Time to First Byte (TTFB) までどのくらいかかりますか?</td></tr></tbody></table>

### メトリクスを作成する

**実験**ページの**メトリクス**タブで、**メトリックを追加**ボタンをクリックします。

![](../experimentation/assets/creating-experiments/001.webp)

メトリックドロワーで、メトリックの情報を入力します。

![](../experimentation/assets/creating-experiments/002.webp)

* `Name`、メトリックの名前
* `Description`、(オプション) メトリックの説明
* `Maintainer`、このメトリックのメンテナー
* `Event type`、FeatBitは現在`custom`イベントタイプのみを持っていますが、実際には以下のタイプをサポートしています：
  * カスタムコンバージョンの場合、セレクターの下で**Conversion rate**を選択する必要があります
  * カスタム数値の場合、セレクターの下で**Numeric**を選択する必要があります
  * クリックコンバージョンとページビューコンバージョンは、カスタムコンバージョンとして扱われます
* `Event name`、FeatBitの実験評価でイベントを識別する名前です。SDKを呼び出してイベントを追跡する際に、この名前がパラメータとして渡されます。
* `Unit`、イベントタイプとしてNumericを選択した場合、測定している数値の種類を識別します。
* `Winning criteria`、`higher than baseline`または`lower than baseline`を選択して勝利基準を定義します

## 実験を作成する

概要サブパネルに戻り、**追加**ボタンをクリックします。

![](../experimentation/assets/creating-experiments/003.webp)

**実験**ドロワーで、以前に作成した機能フラグを選択し、**メトリック**を選択し、ベースラインとしてバリエーションを選択します。**保存**ボタンをクリックします。

![](../experimentation/assets/creating-experiments/004.webp)

## 実験を実行する

実験リストで、実験の**結果を確認**ボタンをクリックします。

![](../experimentation/assets/creating-experiments/005.webp)

機能フラグの**実験**タブに移動します。実験の**開始**ボタンをクリックします。実行が始まります！

![](../experimentation/assets/creating-experiments/006.webp)

## 実験対象者の作成 

フラグのデフォルトルールで実験を実行することも、実験に含める特定のフラグターゲティングルールを選択してカスタム実験対象者を作成することもできます。収集した任意のユーザー属性でターゲティングできます。詳しくは、[ターゲティングルール](../feature-flags/targeting-users-with-flags/targeting-rules.md)をご覧ください。

実験を構築する際には、実験でフラグに遭遇するユーザートラフィックの全体または割合を割り当てることができます。オーディエンス割り当てにより、実験対象者を柔軟に選択でき、正確な実験結果を確保できます。FeatBitは、実験の一部として選択されたユーザーのみを分析します。

特定のフラグターゲティングルールを選択するには、**A/Bテストルールを設定**ボタンをクリックします。

![](../experimentation/assets/creating-experiments/007.webp)

ドロワーパネルで特定のABテストトラフィックを設定できます。以下の画像は、デフォルトルールに一致したユーザー全体の10%のみが実験に含まれていることを示しています。v1のデフォルトルールに一致したユーザーの80%が実験から除外されています。

![](../experimentation/assets/creating-experiments/008.webp)
