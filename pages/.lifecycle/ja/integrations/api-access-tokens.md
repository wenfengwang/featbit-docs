# APIアクセストークン

### 概要

このトピックでは、FeatBit REST APIへの認証にAPIアクセストークンを使用する方法、およびそれらを実装する際の制約と提案について説明します。

> APIアクセストークンは非公開です
> 
> 作成したトークンの秘密の値には、あなただけがアクセスできます。他のアカウントメンバーはそれらにアクセスできません。管理者はトークンを削除することはできますが、その値を表示することはできません。

### 個人用APIアクセストークンのスコープ付け

APIトークンのスコープを設定して、実行可能な操作のセットを制限することができます。たとえば、REST APIへの読み取り専用アクセスを持つ統合を構築することができます。

### アクセストークンの権限を理解する

> 個人用APIアクセストークンと最小特権の原則
>
> ベストプラクティスとして、統合に必要な最小のスコープをトークンに割り当てることをお勧めします。たとえば、統合がプロダクション環境を変更することはない場合、必要に応じて具体的なアクションの権限を使用してアクセスを適切に制限してください。

FeatBitでは2つのタイプのトークンを作成することができます。アカウントメンバーのアカウントにリンクされる個人用トークン、または作成したアカウントとは独立したサービストークンです。

トークン作成者の権限が変更された場合、異なるタイプのトークンを使用することをおすすめします。

#### 個人用トークン

個人用アクセストークンの権限を自分と同じに設定することができます。個人用トークンは、FeatBitでできることを超えることはありません。

自分の権限が減少した場合、作成した個人用トークンのスコープも減少します。たとえば、**ManageFeatureFlag**の権限を持っていて個人用トークンを作成した場合、その後、権限が取り消された場合、トークンもダウングレードされます。そのトークンを使用してフィーチャーフラグにリクエストを行うと、FeatBitは次の結果を返します。

```json
{
    "success": false,
    "errors": [
        "Forbidden"
    ],
    "data": null
}
```

個人用アクセストークンを持つアカウントメンバーがFeatBitのチームから削除されると、その個人用トークンは無効になります。

一時的な使用または個人的な使用のためにFeatBit APIにアクセスする場合は、個人用トークンを使用します。

#### サービストークン

個人用トークンとは異なり、サービストークンはFeatBitのプロフィールには関連していません。既存の権限をサービストークンに割り当てることはできますが、サービストークンに与えることができる権限は自分の権限以上にはなりません。

サービストークンの権限は、作成した後に永久に固定されます。サービストークンの権限を編集することはできず、権限が変更されても、サービストークンの権限は変化しません。

FeatBit APIとの長期的な統合を作成する場合は、サービストークンを使用します。

### APIアクセストークンの作成

**統合/アクセストークン**ページからAPIアクセストークンを作成することができます。

デフォルトでは、作成するトークンは個人用トークンです。トークン作成中に代わりにサービストークンを作成することも選択することができます。

> 新しいトークンをすぐに保存してください
>
> APIアクセストークンは、作成直後に1回だけ表示されます。表示されたトークンを離れたり、ページを更新すると、トークンは非表示になります。トークンにアクセスを失わないために、トークン作成ページを離れる前に新しいアクセストークンを安全な場所にコピーして保存する必要があります。

以下は、**アクセストークン**ページのスクリーンショットです。

![](../integrations/assets/api-access-tokens/001.webp)

アクセストークンを作成するには、次の手順を実行します。

1. **統合/アクセス** **トークン**ページに移動します。
2. ページの右上にある**追加**ボタンをクリックすると、**アクセス トークンの追加**パネルが表示されます。

![](../integrations/assets/api-access-tokens/002.png)

3. アクセストークンにわかりやすい「名前」を付けます。
4. ドロップダウンリストからトークンのタイプを選択します。
5. サービストークンの場合、トークンに付与する権限を割り当てます。
6. **保存**ボタンをクリックします。
7. トークンを安全な場所にコピーして保存します。このページを離れると、トークンは非表示になります。

トークンを作成した後、その名前を編集したり、アクティベートや非アクティベートをしたり、削除したりすることができます。また、このページから既存のトークンを管理することもできます。

### アクセストークンの管理

アクセストークンの管理方法は次のとおりです。

1. **統合/アクセス** **トークン**ページに移動します。
2. リストからトークンを見つけます。
3. トークンの**オーバーフローメニュー**をクリックし、メニューから選択します。

   * 編集：アクセストークンの名前を変更します。
   * アクティベート/非アクティベート：トークンのステータスを切り替えます。トークンは**アクティブ**の状態でのみ使用できます。それ以外の場合、そのトークンを使用して行われたAPI呼び出しはForbiddenの応答になります。
   * 削除：トークンを削除します。この操作を実行すると、トークンは二度と復元することができず、これ以上使用することはできません。

以下は、編集と削除のオプションのスクリーンショットです。

![](../integrations/assets/api-access-tokens/003.png)

### APIアクセストークンを作成および管理できるユーザーの制限

デフォルトでは、**所有者**、**管理者**、または**開発者**ポリシーを持つすべてのアカウントメンバーは、既存の権限に制限されたアクセストークンを作成することができます。アクセストークンリソースに関連する3つの権限があります。

* ListAccessTokens
* ManagePersonalAccessTokens
* ManageServiceAccessTokens

これらのアクションを追加/削除することで、アカウントメンバーがアクセストークンの作成や管理を制限することができます。以下は、アクセストークンに関連するIAMポリシー文のスクリーンショットです。

![](../integrations/assets/api-access-tokens/004.png)