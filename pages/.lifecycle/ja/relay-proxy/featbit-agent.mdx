import { Callout } from 'nextra/components'

# FeatBit エージェント

<Callout type="info">
このドキュメントはFeatBit エージェントの一般的な紹介です。FeatBit エージェントの詳細なインストール手順をお探しの場合は、こちらの[ドキュメント](https://github.com/featbit/featbit-agent#installation)を参照してください。
</Callout>

FeatBit エージェント（GitHub リポジトリは[こちら](https://github.com/featbit/featbit-agent)）は、FeatBit サーバーとSDK間に位置し、FeatBit サーバーのキャッシュ済みリードレプリカとリレープロキシの両方を提供する小さなプログラムです。これにより、FeatBit サーバーへの負荷を増加させることなく、数万の接続されたSDKをサポートするためにFeatBitをスケールアップできます。

FeatBit エージェントは4つの重要な機能を提供します：

* **パフォーマンス**：FeatBit エージェントは機能フラグとセグメントをメモリにキャッシュします。最小リソースで稼働する単独のFeatBit エージェントインスタンスは、数千のWebSocket接続をサポートでき、WebSocket接続を数万にスケールアップしても、FeatBit サーバーを複製することなく対応可能です。 &#x20;
* **低遅延**：FeatBit エージェントは、エンドユーザーに近い位置で実行する機能を備えており、FeatBit サーバーから遠く離れた場所にいるユーザーにとって、遅延を大幅に削減することができます。
* **データ保護**：顧客のインフラストラクチャにFeatBit エージェントをデプロイすると、ユーザー使用データをFeatBit サーバーに転送せずにローカルに保持するか、FeatBit サーバーへ送信する前にデータの匿名化を行うように設定できます。これにより、GDPRおよびその他のデータ保護法に準拠し、ユーザーデータとプライバシーの保護を促進します。
* **回復力**：FeatBit エージェントは、再起動後も正常に機能し、FeatBit サーバーとの接続を失っても操作を続行できるように設計されています。

## コンセプト

FeatBit エージェントは2つの異なるモードをサポートしています：

* エージェント：FeatBit サーバーへの接続をサポートし、動的な機能フラグ、セグメント、環境キーの同期およびその他の高度な機能をサポートします。
* オフライン：FeatBit サーバーへの接続がなく、データと環境キーの完全な制御が可能です。

### エージェントモード

![](../relay-proxy/assets/featbit-agent/001.webp)

エージェントはデフォルトのモードであり、ほとんどの場合にデフォルトで使用する必要があります。エージェントはFeatBit サーバーに接続し、機能フラグ、セグメント、環境キーの真実の源として使用されます。

エージェント上のユーザー使用データは、エージェント上に留めるか、FeatBit サーバーに送信される前に匿名化されるように設定できます。

デフォルトでは、エージェントモードはFeatBit サーバーからフェッチした機能を格納するためにインメモリキャッシュを使用します。しかし、より永続的なストレージソリューションを使用したい場合があります。この目的のために、FeatBit エージェントは、起動時に渡すことで設定可能なRedisまたはバックアップファイルをサポートしています。その際、永続的なバックアップオプションが指定されている場合には、内部キャッシュを補充するためにそれを使用するためにチェックします。これは、FeatBitサーバーにアクセスできない場合に役立ちます。

Redisをストレージソリューションとして使用する場合、複数のエージェントが同じRedisを共有することができ、FeatBit エージェントがクラスターに水平にスケールしてデータの一貫性を維持することができます。

### オフラインモード

![](../relay-proxy/assets/featbit-agent/002.webp)

オフラインモードは、FeatBit サーバーへの接続がない場合に使用する必要があります。クライアントが受け取るデータとそれにアクセスできる環境キーを完全に制御する必要がある場合にも使用できます。

このモードはFeatBitサーバーへ接続しませんので、機能フラグ、セグメント、環境キーのJSONダンプが必要です。FeatBit エージェントインスタンスへこのダンプを送るようにFeatBit サーバーを設定するか、データを含むダンプファイルでエージェントを起動することで、このモードを活用できます。