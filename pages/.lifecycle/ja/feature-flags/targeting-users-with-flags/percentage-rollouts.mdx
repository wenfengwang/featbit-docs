```markdown
import { Callout } from 'nextra/components'

# パーセンテージ・ロールアウト

## 概要 <a href="#overview" id="overview"></a>

このトピックでは、ユーザーに新機能を段階的にリリースするためのパーセンテージ・ロールアウトの使用方法について説明します。

パーセンテージ・ロールアウトを使用すると、新機能をユーザーに段階的に提供することで、展開のリスクを管理できます。新機能をランダムなユーザーの一部に展開し、意図した通りに機能していることがより確信できるようになった段階で、徐々に展開の割合を増やすことができます。

## パーセンテージ・ロールアウトの作成 <a href="#creating-percentage-rollouts" id="creating-percentage-rollouts"></a>

フラグのターゲティングルールまたはフラグのデフォルトルールでパーセンテージ・ロールアウトを作成できます。

以下は、デフォルトルールでのパーセンテージ・ロールアウトのイメージです:

![](../../feature-flags/assets/targeting-users-with-flags/percentage-rollouts/001.png)

この例では、25％のユーザーが新機能を受信します。新機能が予想通りに機能した場合、ユーザーの受信率を徐々に増やし、最終的に100％に達するまで増やすことができます。

非常に少数のユーザーにバリエーションを展開したい場合は、バリエーションに1％未満を割り当てることができます。たとえば、0.125％のように、小数点以下3桁まで使用できます。

## パーセンテージ・ロールアウトのロジックの理解 <a href="#understanding-percentage-rollout-logic" id="understanding-percentage-rollout-logic"></a>

パーセンテージ・ロールアウトを設定すると、各ユーザーにはユーザーキーに基づいて特定のバリエーションが割り当てられます。

パーセンテージ・ロールアウトのロジックは、ユーザーキーIDに基づいたハッシュを生成します。SDKはこのハッシュを使用して、そのユーザーのためのパーセンテージ値を生成します。その値は、パーセンテージ・ロールアウトの値に設定された値と比較され、ユーザーが受信するバリエーションが決まります。ハッシュには0から2147483648までのパーティションがあります。フラグのバリエーションを割り当てる際、ハッシュは各パーティションのユーザーに0から2147483648までの値を順番に割り当てます。たとえば、バリエーションAに50％を割り当てた場合、FeatBitはハッシュの1から1073741824までのパーティションにバリエーションAを提供します。

パーセンテージ・ロールアウトの一般的な使用例は、テスト対象のフラグのユーザーのパーセンテージを時間の経過とともに増やして、ユーザー全体の100％がフラグの1つのバリエーションを受信するようにすることです。ユーザーに割り当てられたフラグのバリエーションのパーセンテージの割り当てを変更すると、ユーザーは0から2147483648までのハッシュリスト内のパーティション位置に基づいて、異なるフラグのバリエーションが再割り当てされます。たとえば、バリエーションAの受信率を50％から70％に変更すると、1073741825から1503238554のパーティションが、すでにバリエーションAを受信しているパーティションのセットに追加されます。

### 高度なロールアウトの使用 <a href="#using-advanced-rollouts" id="using-advanced-rollouts"></a>

**Dispatch by**メニューで任意のユーザー属性に基づいてユーザーにバリエーションを割り当てることができます。

たとえば、ユーザーの25％に新機能を展開することができますが、ランダムにバリエーションを割り当てる代わりに、ユーザーはその`team-region`属性の値に基づいてバリエーションが割り当てられます。これにより、FeatBitは一致する属性-値ペアを持つすべてのユーザーに同じバリエーションを割り当てることが保証されます。

以下は、高度なロールアウトのイメージです:

![](../../feature-flags/assets/targeting-users-with-flags/percentage-rollouts/002.webp)
```