import { Callout } from 'nextra/components'

# ターゲット指向のプログレッシブデリバリー

> **ターゲット指向のプログレッシブデリバリー**
>
> これにより、チームは物事を壊すことなく迅速に進める自信を持つことができます。FeatBitでは、正確なユーザーターゲティングとフィーチャーフラグルールを使用して、リングデプロイメント、パーセンテージデプロイメント、カナリアリリースなど、様々なターゲット指向のロールアウトを可能にします。これらのターゲット指向の段階的リリース戦略、またはリリース進行は、ビッグバンウォーターフォールリリースよりもはるかにリスクが低いです。ターゲット指向のプログレッシブデリバリー技術を用いて、より速くコードを書き、リスクを減らし、顧客体験を継続的に向上させましょう。

## 前提条件

「はじめに」の最後の3つのチュートリアルを既に完了していることを前提としています。

* チュートリアル[デモ用に2つのフィーチャーフラグを作成する](../create-two-feature-flags.md)で、`game_runner`と`difficulty_mode`の2つのフィーチャーフラグを正常に作成しました。
* [「Dino Game」デモとの対話を試す](../try-interacting-with-the-demo.md)方法に関する基本的な経験があります。
* [SDKを接続する](../connect-an-sdk/)方法を知っています（プログラムまたは「Dino Game」デモ用）：
  * デモコードサンプルをダウンロード
  * SDKを初期化
  * カスタマイズされたプロパティを持つユーザーを識別
  * フィーチャーフラグを実装して、機能を提供し制御する

## ゲームの段階的リリース

「Dino Game」を本番環境でテストした後、ゲームが正しく動作するかどうか心配な場合、機能を段階的にリリースすることで、全ユーザーに対するインシデントを避けることができます。デフォルトでは、以下のペースで機能をリリースする計画です。

1. 最初は5%
2. 最初の5%のユーザーにバグがなければ20%
3. 前の20%のユーザーに明らかなバグがなければ50%
4. 前の50%のユーザーに明らかなバグがなければ100%

これを実現するには、デフォルトルールを「ロールアウト割合」に変更し、例えば10%を`true`に、90%を`false`に割り当てます。

![](../../getting-started/assets/targeted-progressive-delivery/001.webp)

これは、ユーザーの10%が変更後のバリエーション`true`を受け取り、DinoGameがそのバリエーションを受け取ったユーザーにリリースされることを意味します。

![](../../getting-started/assets/targeted-progressive-delivery/002.webp)

リリースプロセス中に問題（バグ）に遭遇した場合、ロールアウト割合を再割り当てすることで、機能リリースを即座にロールバックできます。

<Callout type="info">
  ロールアウト割合アルゴリズムは通常のランダム分布アルゴリズムであり、エンドユーザーIDに基づいて計算されます。

  ![](../../getting-started/assets/targeted-progressive-delivery/003.webp)
</Callout>

## 組織への段階的リリース

場合によっては、すべてのユーザーではなく、特定の組織に対して段階的にリリースしたいことがあります。これを実現するためには、「ルール」セクションでルールを作成します。

### ルール用のユーザープロパティを作成する

まず、ポータルでルールプロパティを作成する必要があります。「エンドユーザー」ページに移動し、「プロパティ」ボタンをクリックします。

![](../../getting-started/assets/targeted-progressive-delivery/004.webp)

新しいプロパティ名「orgId」を追加し、「保存」をクリックして作成します。

![](../../getting-started/assets/targeted-progressive-delivery/005.webp)

作成したプロパティに事前定義された値を追加できます。

![](../../getting-started/assets/targeted-progressive-delivery/006.webp)

### プロパティと値をシステムに渡す（開発者専用）

SDKを初期化する際に、プロパティ「orgId」とその値がFeatBitシステムに渡されていることを確認してください。プリセット値（上の画像）で設定したキーが、SDK初期化コードで渡したものと同じであることを確認してください。

![](../../getting-started/assets/targeted-progressive-delivery/007.webp)

FeatBitシステムは、SDKを介して渡されたプロパティとその値を、ポータルで設定したプロパティと値と比較します。

### AA社への段階的リリース

「game_runner」フィーチャーフラグの「ターゲティング」ページに戻ります。先ほど作成したプロパティ「orgId」を使用してルールを作成します。次の手順を実行する必要があります。

1. 名前を付けて新しいルールを追加します（例：AA社への段階的リリース）。
2. 条件を追加し、ユーザーの「orgId」がリストに含まれている場合、そのユーザーは`true`のバリエーションを受け取る可能性が10%になります。

![](../../getting-started/assets/targeted-progressive-delivery/008.webp)

上記で設定したルールにより、DinoGameはAA社のユーザーの10%にリリースされます。リリースプロセス中に問題（バグ）に遭遇した場合、ロールアウト割合を再割り当てすることで、機能リリースを即座にロールバックできます。
