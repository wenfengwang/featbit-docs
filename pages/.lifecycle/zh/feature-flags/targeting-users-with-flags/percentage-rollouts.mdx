
从 'nextra/components' 导入 { Callout }

# 百分比发布

## 概览

本主题解释了如何使用百分比发布功能来逐渐向用户推出新功能。

百分比发布允许您通过逐步向用户推出特性来管理部署的风险。您可以先向一小部分随机用户推出您的特性，随着对特性运行情况的信心增强，逐步增加百分比。

## 创建百分比发布

您可以在功能标志的目标规则或默认规则中创建百分比发布。

这是一个在默认规则中的百分比发布的图示：

![](../../feature-flags/assets/targeting-users-with-flags/percentage-rollouts/001.png)

在这个例子中，25%的用户会接收到新特性。如果新特性按预期工作，您可以逐步提高接收新特性的用户比例，直到最终达到100%。

如果您想向极少数用户推出一个变体，您可以给一个变体分配不到1%的用户比例。您可以使用最多三位小数，比如0.125%。

## 理解百分比发布逻辑

当您设置百分比发布时，每个用户将根据他们的用户键接收到一个特定的变体。

百分比发布逻辑基于用户键ID生成一个哈希值。SDK使用这个哈希值为该用户生成一个百分比值。这个值与设置的百分比发布值进行比较，以确定用户接收到的变体。哈希值的范围是从0到2147483648。当您分配功能标志的变体时，哈希值会按顺序给每个分区的用户分配从0到2147483648的值。例如，当您给变体A分配50%时，FeatBit会将变体A提供给哈希分区从1到1073741824的用户。

百分比发布的一个常见应用场景是随着时间的推移逐步增加标志目标用户的比例，直到100%的用户接收到一个标志的变体。当您改变用户对标志变体的分配比例时，这些用户会根据他们分区在0到2147483648的哈希列表中的位置被重新分配不同的标志变体。例如，如果您将接收变体A的用户比例从50%改为70%，那么分区1073741825到1503238554的用户会被加入到已经接收变体A的用户组中。

### 使用高级发布

您可以根据任何用户属性在**分发依据**菜单中为用户分配变体。

例如，您可以向25%的用户推出一个特性，但不是随机分配变体，而是基于他们的团队-地区属性值分配变体。这确保FeatBit为所有属性值对匹配的用户分配相同的变体。

这是一个高级发布的图示：

![](../../feature-flags/assets/targeting-users-with-flags/percentage-rollouts/002.webp)
