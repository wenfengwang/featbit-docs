import { 提示框 } from 'nextra/components'

# 百分比推出

## 概述 <a href="#overview" id="overview"></a>

本主题解释了如何使用百分比推出逐步向用户发布新功能。

百分比推出可以让您通过逐步向用户发布功能来管理部署风险。您可以将新功能逐渐推出给一小部分随机用户，随着您对功能的预期效果越来越有信心，可以逐渐增加用户接收新功能的百分比。

## 创建百分比推出 <a href="#creating-percentage-rollouts" id="creating-percentage-rollouts"></a>

您可以在标志的定位规则或标志的默认规则中创建百分比推出。

以下是默认规则中百分比推出的示例图像：

![](../../feature-flags/assets/targeting-users-with-flags/percentage-rollouts/001.png)

在此示例中，25% 的用户将收到新功能。如果新功能按预期工作，您可以逐步增加用户接收新功能的百分比，直到最终达到 100%。

如果您想向极少数用户推出变体，可以将一个变体分配少于 1%。您最多可以使用三位小数，例如，0.125%。

## 了解百分比推出逻辑 <a href="#understanding-percentage-rollout-logic" id="understanding-percentage-rollout-logic"></a>

当您设置百分比推出时，每个用户根据其用户密钥会收到特定的变体。

百分比推出逻辑会根据用户的密钥生成一个哈希值。SDK 使用此哈希值为用户生成一个百分比数值。该数值与百分比推出数值进行比较，从而确定用户会收到哪个变体。哈希值的范围是从 0 到 2147483648。在分配标志的变体时，哈希值会按顺序分配给每个分区中的用户，范围是从 0 到 2147483648。例如，当您将变体 A 分配了 50% 时，FeatBit 会将变体 A 分配给哈希分区从 1 到 1073741824 的用户。

百分比推出的一个常见用例是随着时间的推移逐步增加标志所针对的用户的百分比，直到 100% 的用户收到标志的一个变体。当您更改用户对标志变体的百分比分配时，这些用户会根据它们在 0 到 2147483648 哈希列表中的分区位置重新分配不同的标志变体。例如，如果您将接收变体 A 的用户的百分比从 50% 更改为 70%，那么 1073741825 到 1503238554 的分区将被添加到已经接收变体 A 的分区集合中。

### 使用高级推出 <a href="#using-advanced-rollouts" id="using-advanced-rollouts"></a>

您可以根据“调度依据**”菜单中的任何用户属性将变体分配给用户。

例如，您可以向 25% 的用户推出一项功能，但不是随机分配到变体，而是根据用户的`team-region`属性值来分配用户到变体。这可以确保 FeatBit 将具有匹配属性值对的所有用户分配给同一个变体。

以下是一个高级推出的示例图像：

![](../../feature-flags/assets/targeting-users-with-flags/percentage-rollouts/002.webp)