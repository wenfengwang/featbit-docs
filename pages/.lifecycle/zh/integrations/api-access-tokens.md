# API 访问令牌

### 概述

本主题介绍如何使用 API 访问令牌通过 FeatBit REST API 进行身份验证，以及实现这些令牌的约束和建议。

> API 访问令牌是私有的
>
> 只有您能够访问您创建的令牌的秘密值。其他账户成员无法访问它们。管理员可以删除您的令牌，但无法查看其值。

### 限定个人 API 访问令牌的作用域 

您可以限定 API 令牌的作用域，以限制它们可以执行的操作集合。例如，您可以构建一个仅具有对 REST API 的读取访问权限的集成。

### 理解访问令牌权限 

> 个人 API 访问令牌与最小权限原则
>
> 作为最佳实践，我们建议您为令牌提供集成所需的最小作用域。例如，如果您的集成不是设计用来修改生产环境的，请根据您的需求使用特定的权限操作来适当限制访问。

您可以在 FeatBit 中创建两种类型的令牌。您可以创建一个个人令牌，它与账户成员的账户相关联，或者创建一个服务令牌，它独立于创建它的账户。

当其创建者的权限发生变化时，不同类型的令牌会有不同的反应。因此，您可能希望为不同的用途使用不同类型的令牌。

#### 个人令牌 

您可以配置个人访问令牌，使其具有与您相同的权限。您的个人令牌永远不能比您在 FeatBit 中能做的更多。

如果您自己的权限被减少，您创建的个人令牌的作用域也会相应减少。例如，如果您拥有 **ManageFeatureFlag** 权限并创建了一个个人令牌，但后来这个权限被您移除，您的令牌也会被降级。如果您使用该令牌请求功能标志，FeatBit 将返回以下结果：

```json
{
    "success": false,
    "errors": [
        "Forbidden"
    ],
    "data": null
}
```

如果一个拥有个人访问令牌的账户成员被移除出您的 FeatBit 团队，他们的个人令牌将被停用。

当您想要为临时或个人用途访问 FeatBit API 时，使用个人令牌。

#### 服务令牌 

与个人令牌不同，服务令牌不绑定到您的 FeatBit 账户。您可以为服务令牌分配现有的权限，但您不能赋予服务令牌超出您自己权限的权限。

服务令牌的权限在您创建它之后就永久固定了。您不能编辑服务令牌的权限，即使您的权限发生变化，服务令牌的权限也保持不变。

使用服务令牌来创建与 FeatBit API 的长期集成。

### 创建 API 访问令牌 

您可以从 **Integrations/Access tokens** 页面创建 API 访问令牌。

默认情况下，您创建的是个人令牌。您可以在令牌创建流程中选择创建服务令牌。

> 立即保存新令牌
>
> 您的 API 访问令牌在创建后立即可见一次。如果您离开或刷新显示令牌的页面，令牌将被隐藏且不再可见。在离开创建页面之前，您必须将新的访问令牌复制并存储在安全的地方，否则您将失去对令牌的访问。

以下是 **Access tokens** 页面的屏幕截图：

![](../integrations/assets/api-access-tokens/001.webp)

要创建访问令牌，请执行以下操作：

1. 导航到 **Integrations/Access tokens** 页面。
2.  点击页面右上角的 **Add** 按钮，**Add Access Token** 面板会出现\

![](../integrations/assets/api-access-tokens/002.png)

3. 为您的令牌指定一个易于理解的 **Name**。
4. 从下拉列表中选择令牌的类型。
5. 如果是服务令牌，分配您希望授予令牌的权限。
6. 点击 **Save** 按钮。
7. 将令牌复制并保存在一个安全的地方。一旦您离开这个页面，令牌就会被隐藏。

创建令牌后，您可以编辑它的名称、激活、停用或删除它。您也可以从这个页面管理现有的令牌。

### 管理访问令牌 

要管理访问令牌，请执行以下操作：

1. 导航到 **Integrations/Access tokens** 页面。
2. 在列表中找到您的令牌。
3. 点击令牌的 **overflow menu**，然后从菜单中选择：\

   * Edit：修改访问令牌的名称。
   * Activate/Deactivate：切换令牌的状态。令牌只有在其状态为 **active** 时才能使用。否则，使用该令牌进行的 API 调用将返回 Forbidden 响应。
   * Remove：允许删除令牌。如果执行此操作，令牌将无法恢复，也无法再次使用。

以下是编辑和删除选项的屏幕截图：

![](../integrations/assets/api-access-tokens/003.png)

### 限制谁可以创建和管理 API 访问令牌 

默认情况下，所有具有 **Owner**、**Administrator** 或 **Developer** 策略的账户成员都可以创建限于其现有权限的访问令牌。与访问令牌资源相关的权限有三个：

* ListAccessTokens
* ManagePersonalAccessTokens
* ManageServiceAccessTokens

您可以通过添加/删除这些操作来使用 IAM 策略限制账户成员创建或管理访问令牌。以下是与访问令牌相关的 IAM 策略声明的屏幕截图。

![](../integrations/assets/api-access-tokens/004.png)
