
# 生产环境测试

> 什么是**生产环境测试**
> 生产环境是无法完全复制的。要真正了解一个功能在现实世界中的表现，唯一确切的方式是直接在真实用户中进行测试。功能开关能够让您安全地在生产环境中进行测试。利用FeatBit的目标定位功能，将新功能仅暴露给特定的用户子集。如果系统性能出现问题，您可以中止功能的发布，并限制问题的影响范围。但如果一切顺利，您就可以逐步向更广泛的用户群推出新功能。

## 先决条件

我们假设您已经完成了“入门”系列教程的最后三篇：

* 您已经成功创建了两个功能标志`game runner`和`difficulty mode`在教程[Create 2 flags for the demo](../create-two-feature-flags.md)中。
* 您已经具备了与[“`恐龙游戏`" 演示](../try-interacting-with-the-demo.md)交互的基本经验。
* 您知道如何将[SDK连接](../connect-an-sdk/)到您的程序或“恐龙游戏”演示：
  * 下载演示代码样例
  * 初始化SDK
  * 识别具有自定义属性的用户
  * 实现功能标志以交付和控制功能

## 在生产环境中使用真实用户进行测试

游戏已经部署到线上。在您将其发布给所有玩家之前，您想先让一些密友进行测试。您可以使用“目标用户”功能，将您的朋友加入到“白名单”中。

前往您的“游戏运行器”功能标志的目标页面，展开“目标用户”部分。您将看到两个选择列表，分别对应变量值true和false。

要将您的朋友加入到“白名单”，我们只需：

1. 将您朋友的游戏用户名添加到标记为true的选择列表下。
2. 激活功能标志。
3. 将默认规则设置为false。

上述三个步骤向FeatBit表明功能标志“游戏运行器”已被激活。只有在“目标用户”部分标记为true的用户列表中的用户才能体验到该功能（即可以玩游戏）。

![](../../getting-started/assets/testing-in-production/001.webp)

### 用户从哪里来？

在true列表中的用户可以通过以下三种方式导入：

1. 在“数据同步”部分，您可以通过预定义的JSON文件将所有用户批量导入到FeatBit。
![](../../getting-started/assets/testing-in-production/002.webp)
2. 当用户在您的运行应用程序中注册时，用户信息会保存到系统中。
![](../../getting-started/assets/testing-in-production/003.webp)
3. 您也可以直接在“目标用户”选择列表中输入用户名。如果用户尚不存在，系统将会在“最终用户”列表中添加一个新用户。

您可以在“最终用户”页面查看用户信息。

![](../../getting-started/assets/testing-in-production/004.webp)

## 在生产环境中使用QA分组进行测试

您的朋友们喜欢您的游戏，并希望能够在正式发布给公众之前，始终有机会测试新功能。他们成为了可重复使用的测试用户（相当于QA团队）。为了让我们下次发布新功能时工作更加轻松，您可以创建一个名为QA的用户分组，每次部署游戏的新功能时都会使用这个分组。

前往“细分”页面，创建一个名为“我亲爱的QA团队”的细分。

![](../../getting-started/assets/testing-in-production/005.webp)

在细分详情页面，我们将我亲爱的测试用户添加到“包含用户”列表中，然后点击保存。这个分组可以跨多个功能标志共享。

![](../../getting-started/assets/testing-in-production/006.webp)

我们返回到功能标志列表，并打开“游戏运行器”功能标志的“目标”页面。

1. 清除“目标用户”部分true列表中的所有用户。
2. 将“我亲爱的QA团队”添加到自定义规则中。
   1. 添加一个新的自定义规则并为其命名（例如，“生产环境测试规则”）。
   2. 选择“用户属于细分”作为IF条件。
   3. 在部分列表中选择“我亲爱的QA团队”。
   4. 在服务区域选择true。

![](../../getting-started/assets/testing-in-production/007.webp)

以上配置表示，如果用户属于“我亲爱的QA团队”分组，恐龙游戏将对这些用户发布。这个配置也可以应用到其他功能标志上，用于生产环境中测试其他功能，如“难度模式”。

![](../../getting-started/assets/testing-in-production/008.webp)

这个分组也被称为可复用分组，可以跨多个功能标志使用。更新一个分组意味着更新所有使用该分组的功能标志。
