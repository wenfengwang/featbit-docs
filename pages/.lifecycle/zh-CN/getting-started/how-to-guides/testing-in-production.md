# 在生产环境中进行测试

> 什么是**在生产环境中进行测试**？
>
> 无法复制生产环境。想要了解一个功能在真实世界中的表现如何，唯一确实的方法是与真实用户进行测试。功能标志（Feature flags）为您提供了安全地在生产环境中进行测试的控制权。利用FeatBit的定位能力，将新功能暴露给特定用户群体的子集。如果系统性能下降，您可以停止发布，并限制事故的影响范围。但如果一切顺利，您可以逐步将新功能发布给更广泛的受众。

## 先决条件

我们假设您已完成“入门”的最后3个教程：

* 您已成功在教程 [创建2个演示用标志](../create-two-feature-flags.md) 中创建了两个功能标志“游戏运行者”和“难度模式”。
* 您对如何[与“Dino游戏”演示](../try-interacting-with-the-demo.md)进行交互有基本的经验。
* 您知道如何[连接SDK](../connect-an-sdk/)到您的程序或“Dino游戏”演示：
  * 下载演示代码示例
  * 初始化SDK
  * 用自定义属性标识一个用户。
  * 实施功能标志以提供和控制功能

## 使用个别用户进行生产环境测试

游戏已经部署在线上。在将其发布给所有玩家之前，您希望与一些亲密的朋友进行测试。您可以使用“定位用户”部分将您的朋友添加到“allowlist”中。

转到“游戏运行者”功能标志的定位页面，展开“定位用户”部分。您将看到每个变量`true`和`false`的两个选择列表。

为了将您的朋友添加到“allowlist”中，只需要：

1. 在`true`下面的选择列表中添加您的朋友的游戏用户名。
2. 打开功能标志。
3. 将默认规则设置为`false`。

上述三个步骤告诉FeatBit该功能标志“游戏运行者”已打开。只有在目标用户部分的true列表中的用户才能获得`true`的变体（可以玩游戏）。

![](../../getting-started/assets/testing-in-production/001.webp)

### 用户来源是什么？

目标用户中的用户可以通过三种方式导入：

1. 在“数据同步”部分，您可以通过预定义的JSON文件将所有用户导入到FeatBit。
![](../../getting-started/assets/testing-in-production/002.webp)
2. 当用户在您的运行应用程序中注册时，用户信息将保存到系统中。
![](../../getting-started/assets/testing-in-production/003.webp)
3. 您还可以直接在“定位用户”选择列表中输入用户名。如果用户不存在，它会将一个新用户添加到“最终用户”列表中。

用户信息可以在“最终用户”页面找到。

![](../../getting-started/assets/testing-in-production/004.webp)

## 使用QA分段进行生产环境测试

您的朋友喜欢您的游戏，他们想在发布给公众之前始终进行新功能测试。他们成为了测试的可重用用户（就像QA团队）。为了使我们下次发布新功能更轻松一些，您可以创建一个QA分段，每次部署游戏的新功能时都会使用该分段。

转到“分段”页面，创建一个名为“我可爱的QA团队”的分段。

![](../../getting-started/assets/testing-in-production/005.webp)

在分段详细页面，我们将可爱的测试用户添加到“包括用户”列表中，然后点击保存。这个分段可以在不同的功能标志之间共享使用。

![](../../getting-started/assets/testing-in-production/006.webp)

我们回到功能标志列表，打开“游戏运行者”功能标志的“定位”页面。

1. 删除“定位用户”部分true列表中的所有用户。
2. 将“我可爱的QA团队”添加到自定义规则中。
   1. 添加一个新的自定义规则并为其命名（例如，“在生产中进行测试的规则”）。
   2. 将“用户在分段中”选择为IF条件。
   3. 在部分列表中选择“我可爱的QA团队”部分。
   4. 在服务区域中选择`true`。

![](../../getting-started/assets/testing-in-production/007.webp)

上述配置意味着如果用户在“我可爱的QA团队”分段中，DinoGame将对该用户进行发布。此配置也可以在其他功能标志中实施，用于测试其他功能的生产环境，例如“难度模式”。

![](../../getting-started/assets/testing-in-production/008.webp)

这个分段也称为可重用分段，可以在不同的功能标志之间共享使用。更新一个分段意味着更新所有使用该分段的功能标志。